
<!DOCTYPE HTML>
<html>
<head>
	<meta charset="utf-8">
	<title>emacs + org-mode + octopress + github - 一个热爱木工的软件工程师</title>
	<meta name="author" content="靖天">

	
	<meta name="description" content="网站基本上搭起来了，虽然不懂Ruby，Jekyll也只知道是个什么东西。但是就how-to问题，可以和大家分享下。如果你想建立静态博客，也许有点头绪。如果你恰巧也使用emacs+orgmode，那我们就有更多共同语言了：） 什么是静态博客 静态博客（Static Blog）。。 &hellip;">
	
	<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

	<link href="/atom.xml" rel="alternate" title="Geek Woodworker" type="application/atom+xml">
	<link rel="canonical" href="">
	<link href="/favicon.ico" rel="shortcut icon">
	<link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
	<!--[if lt IE 9]><script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script><![endif]-->
	<script src="//ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js"></script>
  
	<script type="text/javascript">
		var _gaq = _gaq || [];
		_gaq.push(['_setAccount', 'UA-33860711-1']);
		_gaq.push(['_trackPageview']);

		(function() {
			var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
			ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
			var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
		})();
	</script>


	<!-- 9jBDGwX2G-7pQ39zs-wElUxm5Tg -->
<meta name="alexaVerifyID" content="9jBDGwX2G-7pQ39zs-wElUxm5Tg" />

</head>


<body>
	<header id="header" class="inner"><h1><a href="/">Geek Woodworker</a></h1>
<nav id="main-nav"><ul class="main">
	<li><a href="/">主页</a></li>
	<li><a href="/blog/archives">目录</a></li>
	<li><a href="/blog/categories">类别</a></li>
</ul>
</nav>
<nav id="mobile-nav">
	<div class="alignleft menu">
		<a class="button">Menu</a>
		<div class="container"><ul class="main">
	<li><a href="/">主页</a></li>
	<li><a href="/blog/archives">目录</a></li>
	<li><a href="/blog/categories">类别</a></li>
</ul>
</div>
	</div>
	<div class="alignright search">
		<a class="button"></a>
		<div class="container">
			<form action="http://google.com/search" method="get">
				<input type="text" name="q" results="0">
				<input type="hidden" name="q" value="site:ifq.github.com">
			</form>
		</div>
	</div>
</nav>
<nav id="sub-nav" class="alignright">
	<div class="social">
		
		
		<a class="google" href="https://plus.google.com/115086707443303900229?rel=author" title="Google+">Google+</a>
		
		
		
		<a class="github" href="https://github.com/ifq" title="GitHub">GitHub</a>
		
		
		
		
		
		<a class="rss" href="/atom.xml" title="RSS">RSS</a>
		
	</div>
	<form class="search" action="http://google.com/search" method="get">
		<input class="alignright" type="text" name="q" results="0">
		<input type="hidden" name="q" value="site:ifq.github.com">
	</form>
</nav>


</header>
	
		
	
	<div id="content" class="inner"><article class="post">
	<h1 class="title">Emacs + Org-mode + Octopress + Github</h1>
	<div class="entry-content"><p>
网站基本上搭起来了，虽然不懂Ruby，Jekyll也只知道是个什么东西。但是就how-to问题，可以和大家分享下。如果你想建立静态博客，也许有点头绪。如果你恰巧也使用emacs+orgmode，那我们就有更多共同语言了：）
<!--more-->


</p>
<div id="outline-container-1" class="outline-2">
<h2 id="sec-1">什么是静态博客</h2>
<div class="outline-text-2" id="text-1">

<p>  静态博客（Static Blog）。。就是静态网页组成的博客。与之对比的动态博客，也就是页面是动态生成的，博客内容依存于数据库，国内各大网站提供的博客系统大都是动态博客。
</p>
<p>
  静态博客的页面可以是手工通过制作html页面来维护，这样的话博客最基本的按日期管理、文章分类等特征都得手工完成，这么笨拙的办法可能没人喜欢。于是现在多是使用辅助工具帮助生成整个博客站点，文章自动按照日期管理、有类别或者TAG分类、还融合了留言板等其他技术，octopress就是其中一员。
</p>
</div>

</div>

<div id="outline-container-2" class="outline-2">
<h2 id="sec-2">什么是octopress</h2>
<div class="outline-text-2" id="text-2">

<p>  说到 <a href="#www.octopress.org">octopress</a>，得先说说 <a href="http://jekyllrb.com/">jekyll</a>。 jekyll 可以把以日期为文件名的 <a href="http://en.wikipedia.org/wiki/Markdown">markdown</a> 格式的文本文件转换为html的静态博客。
</p><blockquote>

<p>Jekyll is a simple, blog aware, static site generator. It takes a template directory (representing the raw form of a website), runs it through Textile or Markdown and Liquid converters, and spits out a complete, static website suitable for serving with Apache or your favorite web server. 
</p>
</blockquote>


<p>
  可以理解为jekyll是实际转化生成静态站点的脚本程序，而octopress是套在jekyll外的一层封装，使得最终生成的站点上有更好的UI，更有风格，并且有更丰富的辅助功能（留言、代码展示、视频）。与octopress类似的还有<a href="http://jekyllbootstrap.com/">bootstrip</a>。 我在公司里记录一些东西也在用，只是觉得 octopress 对移动设备的支持更好，所以才打算在公开博客里使用它。
</p>
<p>
  生成和更新服务器的命令大致如下,每次写完内容后要做的操作：
<figure class='code'><figcaption><span>生成＆更新博客的命令</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
</pre></td><td class='code'><pre><code class='sh'><span class='line'>rake generate   <span class="c">#将source目录下的markdown文本生产为public目录下的blog</span>
</span><span class='line'>rake preview    <span class="c">#本地预览 localhost:4000</span>
</span><span class='line'>rake deploy     <span class="c">#根据public目录生成_deploy目录并上传github </span>
</span><span class='line'><span class="c">#上边的操作已经更新了网站服务器，以下是保存代码改动到github服务器的其他branch               </span>
</span><span class='line'>git add .
</span><span class='line'>git commit -m <span class="s2">&quot;comments&quot;</span>
</span><span class='line'>git push
</span></code></pre></td></tr></table></div></figure>

</p></div>

</div>

<div id="outline-container-3" class="outline-2">
<h2 id="sec-3">什么是emacs</h2>
<div class="outline-text-2" id="text-3">

<p>  <a href="http://en.wikipedia.org/wiki/Emacs">emacs</a> 是一个拥有强大扩展能力的文本编辑器，扩展能力强大到可以浏览网页、发微博、调试程序、管理日程，总之什么都可以做。我本人并不是一个all-in-emacs控，我不会用emacs做发微博这类的事情，但是还是很喜欢用它工作。它有几个特点吸引我：
</p><ul>
<li>免费。
</li>
<li>丰富的辅助开发功能，比如和SVN，GIT的融合，编译make的融合。
</li>
<li>快捷键便利。
</li>
<li>不断在更新，比如现在对多国语言的支持越来越好。
</li>
<li>全球范围内强大的技术支持，网上资源很多。
</li>
</ul>




  <img src="/rc/emacs.png" width="800" height="600" title=" " alt="emacs 启动界面">

<p>
  既然emacs这么好，如果熟悉它的话，自然写博客的时候也想用它了。单纯用emacs来写markdown格式的文本固然也可以，也有相应的emacs模式配合。但是寡人不熟悉markdown格式，相反对同类型的功能更强大的org-mode略知一二，所以就想用org格式来写博客。
</p>
</div>

</div>

<div id="outline-container-4" class="outline-2">
<h2 id="sec-4">什么是org-mode</h2>
<div class="outline-text-2" id="text-4">

<p>  <a href="http://orgmode.org/">org-mode</a> 是emacs的一种扩展模式，是在 <a href="http://emacswiki.org/emacs/OutlineMode">outline mode</a> 基础上发展出来的一种文本编辑辅助模式。适合在编写大纲（outline）组织结构的文档时使用。orgmode拥有丰富的快捷键由于编辑文档，支持url link，有强大的TODO、Agenda功能用于组织计划、有方便的表格功能、可以快捷的将org文档导出成html、pdf、laTex等格式的文档。
</p>
<p>
  <img src="/rc/orgmode.jpg" width="800" height="600" title=" " alt="简单的org模式的界面">
</p>
<p>
  这里重点说一下org模式下的html导出功能。org模式可以通过配置，将指定文件夹下的所有org文件导出到一个指定文件夹内（包括子文件的层级关系），org文件之间的link也会转化为html的link，因此直接使用这个功能就可以很方便的用org模式维护一个简单的静态网站。
</p>


<figure class='code'><figcaption><span>org模式publish配置示例 </span></figcaption>
<div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>(setq org-publish-project-alist
</span><span class='line'>      '(("note-org"
</span><span class='line'>         :base-directory "~/org/"
</span><span class='line'>         :publishing-directory "~/pub/"
</span><span class='line'>         :base-extension "org"
</span><span class='line'>         :recursive t
</span><span class='line'>         :publishing-function org-publish-org-to-html
</span><span class='line'>     :headline-levels 3
</span><span class='line'>     :html-extension "html"
</span><span class='line'>     :table-of-contents t
</span><span class='line'>     :link-home "/index.html"
</span><span class='line'>     :section-numbers t
</span><span class='line'>     :style "&lt;link rel=\"stylesheet\" href=\"/org.css\" type=\"text/css\"/>"
</span><span class='line'>     )
</span><span class='line'>
</span><span class='line'>        ("note-static"
</span><span class='line'>         :base-directory "~/org/"
</span><span class='line'>         :publishing-directory "~/pub/"
</span><span class='line'>         :recursive t
</span><span class='line'>         :base-extension "css\\|js\\|bmp\\|png\\|jpg\\|gif\\|pdf\\|mp3\\|swf\\|zip\\|gz\\|txt\\|el\\|pl\\|mht\\|log\\|bin_\\|bat\\|tst\\|doc\\|docx\\|gz"
</span><span class='line'>         :publishing-function org-publish-attachment
</span><span class='line'>     )
</span><span class='line'>        ("note" 
</span><span class='line'>         :components ("note-org" "note-static")
</span><span class='line'>         :author "wangjingtian@xxx.com.cn"
</span><span class='line'>         )))</span></code></pre></td></tr></table></div></figure>

<p>
  通过上边的设置我只需要一个快捷键就可以将 <code>~/org/</code> 下的org文件全部导成 html 存在 <code>~/pub</code> 下。
</p><ul>
<li>org子文件层级关系保留
</li>
<li>可以为导出的html指定css格式
</li>
<li>org文件夹内的其他格式的文件，如图片也可以设置一并导入pub目录
</li>
<li>可以自动生成org文件内的目录（TOC）
</li>
</ul>


</div>

</div>

<div id="outline-container-5" class="outline-2">
<h2 id="sec-5">how-to 整合</h2>
<div class="outline-text-2" id="text-5">

<p>  终于到了org与octopress整合的部分了。关于整合 orgmode 和 octopress（jekyll），可以找到几种方式：
</p><ul>
<li>org 导出html，直接交给 jekyll 处理。这么做有个问题，org生成的html可能和 markdown 产生的html有差异，有的时候兼容性不好。比如，插入 <code>&lt;!--more--&gt;</code> 语句时，由于 org 生成的 html 充满了 div ，导致在有 headline 的情况下页面可能会乱掉。
</li>
<li>org 文件通过 emacs 的插件转换为 markdown 格式，再由 jekyll 处理。可以到<a href="https://github.com/alexhenning/ORGMODE-Markdown">这里</a> 找到相关资源。
</li>
<li><a href="http://orgmode.org/worg/org-tutorials/org-ruby.html">org-ruby</a>。 通过Ruby将 org 文件转化为 html，而不是通过emacs。<br/>
</li>
</ul>


<p>
  目前为止，我采用的还是第一种方法。
</p>
</div>

<div id="outline-container-5-1" class="outline-3">
<h3 id="sec-5-1">目录结构</h3>
<div class="outline-text-3" id="text-5-1">

<p>   以下是我现有的目录结构供参考
</p>


<pre class="example">+ blog               # 博客根目录
   + org             # org文件根目录
      + _post
   + source          # org导出根目录，也是octopress本身用于生成blog的根目录
      + _post        # markdown或者org导出的html存在这里
      + _include     # 这里是一些octopress的UI template文件
      + _layouts     # 这里也是
      + rc           # 我的照片等资源的文件夹
      + video        # 我的视频文件夹
      + ...
   + public          # 通过命令 source下的内容会自动导出到 该目录，包括自定义的 rc、video
      + blog         # 内部的子文件按年月日排列
      + rc
      + video
      + ...
   + _deploy         #通过部署命令生产，为了更新github而产生
      + ...
</pre>


</div>

</div>

<div id="outline-container-5-2" class="outline-3">
<h3 id="sec-5-2">emacs 设定</h3>
<div class="outline-text-3" id="text-5-2">

<p>   以下.emacs文件的设置有几个要点：
</p><ul>
<li>jekyll 本身针对 markdown 转化设计，但实际也支持html。但是org模式导出html时要设置为 <code>body-only</code> ，只导出html的body的部分，页面head和footer的内容由 jekyll 生成。
</li>
<li>最好不要导出目录（TOC）。
</li>
<li>base和publishing目录的设置
</li>
<li>虽然设置了资源文件的导出，但是我目前实际没有使用，而是直接把图片等资源文件放到 <code>source/rc/</code> 下。
</li>
</ul>


<figure class='code'><figcaption><span>生成＆更新博客的命令</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
</pre></td><td class='code'><pre><code class='sh'><span class='line'><span class="o">(</span>setq org-publish-project-alist
</span><span class='line'>      <span class="err">&#39;</span><span class="o">((</span><span class="s2">&quot;blog-org&quot;</span>
</span><span class='line'>         :base-directory <span class="s2">&quot;~/blog/org/&quot;</span>
</span><span class='line'>         :publishing-directory <span class="s2">&quot;~/blog/source/&quot;</span>
</span><span class='line'>         :base-extension <span class="s2">&quot;org&quot;</span>
</span><span class='line'>         :recursive t
</span><span class='line'>         :publishing-function org-publish-org-to-html
</span><span class='line'>     :headline-levels 4
</span><span class='line'>     :html-extension <span class="s2">&quot;html&quot;</span>
</span><span class='line'>     :body-only t ;; Only <span class="nb">export </span>section between &lt;body&gt; &lt;/body&gt;
</span><span class='line'>     :table-of-contents nil
</span><span class='line'>     <span class="o">)</span>
</span><span class='line'>
</span><span class='line'>        <span class="o">(</span><span class="s2">&quot;blog-static&quot;</span>
</span><span class='line'>         :base-directory <span class="s2">&quot;~/blog/org/&quot;</span>
</span><span class='line'>         :publishing-directory <span class="s2">&quot;~/blog/source/&quot;</span>
</span><span class='line'>         :recursive t
</span><span class='line'>         :base-extension <span class="s2">&quot;css\\|js\\|bmp\\|png\\|jpg\\|gif\\|pdf\\|mp3\\|swf\\|zip\\|gz\\|txt\\|el\\|pl\\|mht\\|log\\|bin_\\|bat\\|tst\\|doc\\|docx\\|gz&quot;</span>
</span><span class='line'>         :publishing-function org-publish-attachment
</span><span class='line'>     <span class="o">)</span>
</span><span class='line'>        <span class="o">(</span><span class="s2">&quot;blog&quot;</span>
</span><span class='line'>         :components <span class="o">(</span><span class="s2">&quot;blog-org&quot;</span> <span class="s2">&quot;blog-static&quot;</span><span class="o">)</span>
</span><span class='line'>         :author <span class="s2">&quot;靖天&quot;</span>
</span><span class='line'>         <span class="o">)))</span>
</span></code></pre></td></tr></table></div></figure>   
</div>

</div>

<div id="outline-container-5-3" class="outline-3">
<h3 id="sec-5-3">操作</h3>
<div class="outline-text-3" id="text-5-3">

<p>   假如今天要写这篇新的博客，大致过程如下：
</p><ul>
<li>用emacs创建 <code>blog/org/_post/2012-08-11-org-octopress.org</code> 这个文件。(日期的部分设置了快捷键直接添加)
</li>
<li>在文件的头部加入如下内容：(这部分可以通过 <a href="http://code.google.com/p/yasnippet/">YASnippet</a> 加速添加)



<pre class="example">#+BEGIN_HTML
---
layout: post
title: emacs + org-mode + octopress + github
categories: [binary, orgmode, octopress]
comments: true
---
ORG-LIST-END-MARKER
</pre>

</li>
<li>用org模式写博客的内容。
</li>
<li>用 <code>org-publish</code> 命令导出这个org文件。
</li>
<li><code>rake generate</code> 生成博客
</li>
<li><code>rake preview</code> 可以本地先检查下
</li>
<li><code>rake deploy</code> 部署到服务器
</li>
</ul>


<p>
以上内容仅是让还未入门的同鞋了解下用octopress写博客大概的流程是什么样子。如果你不熟悉命令行，或者觉得这种方式写博客过于繁琐，那可能并不适合你。但是如果你熟悉命令行或者脚本，可以给你写博客带来不一样的感受。比如要添加很多图片到一篇博客，可以用脚本便利目录下的所有图片自动生产相应的语句，或者做更酷的事情。
</p>
<p>
Thanks for watching. Any comments and suggestions are welcomed.
</p></div>
</div>
</div>
</div>


<div class="meta">
	<div class="date">








  


<time datetime="2012-08-10T00:00:00+08:00" pubdate data-updated="true">Aug 10<span>th</span>, 2012</time></div>
	<div class="tags">


	<a class='category' href='/blog/categories/binary/'>binary</a>, <a class='category' href='/blog/categories/octopress/'>octopress</a>, <a class='category' href='/blog/categories/orgmode/'>orgmode</a>


</div>
	
		<span class="comments"><a href="/blog/2012/08/10/org-octopress/#disqus_thread">Comments</a></span>
	
</div></article>

	<div class="share">
	<div class="addthis_toolbox addthis_default_style ">
	
	
	<a class="addthis_button_tweet"></a>
	
	
	<a class="addthis_button_google_plusone" g:plusone:size="medium"></a>
	
	<!--a class="addthis_counter addthis_pill_style"></a-->

<!-- JiaThis Button BEGIN -->
<div id="ckepop">
	<span class="jiathis_txt">分享到：</span>
	<a class="jiathis_button_qzone"></a>
	<a class="jiathis_button_tsina"></a>
	<a class="jiathis_button_tqq"></a>
	<a class="jiathis_button_renren"></a>
	<a class="jiathis_button_kaixin001"></a>
	<a href="http://www.jiathis.com/share?uid=1663055" class="jiathis jiathis_txt jtico jtico_jiathis" target="_blank"></a>
	<a class="jiathis_counter_style"></a>
</div>
<script type="text/javascript">var jiathis_config = {data_track_clickback:true};</script>
<script type="text/javascript" src="http://v3.jiathis.com/code/jia.js?uid=1344059400115285" charset="utf-8"></script>
<!-- JiaThis Button END -->

	</div>
  <script type="text/javascript" src="http://s7.addthis.com/js/250/addthis_widget.js#pubid="></script>
</div>



<section id="comment">
    <h1 class="title">Comments</h1>
    <div id="disqus_thread" aria-live="polite"><noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
</div>
</section>
</div>
	<footer id="footer" class="inner">Copyright &copy; 2012

    靖天
    (一个热爱木工的软件工程师)


</footer>
	<script src="/javascripts/slash.js"></script>
<script src="/javascripts/jquery.fancybox.pack.js"></script>
<script type="text/javascript">
(function($){
	$('.fancybox').fancybox();
})(jQuery);
</script> <!-- Delete or comment this line to disable Fancybox -->


<script type="text/javascript">
      var disqus_shortname = 'ifq';
      
        
        // var disqus_developer = 1;
      //var disqus_identifier = '';
      //var disqus_url = '';
      var disqus_identifier = 'http://ifq.github.com/blog/2012/08/10/org-octopress/';
      var disqus_url = 'http://ifq.github.com/blog/2012/08/10/org-octopress/';
        var disqus_script = 'embed.js';
      
    (function () {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = 'http://' + disqus_shortname + '.disqus.com/' + disqus_script;
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>


<!-- 
	<script type="text/javascript">
		var _gaq = _gaq || [];
		_gaq.push(['_setAccount', 'UA-33860711-1']);
		_gaq.push(['_trackPageview']);

		(function() {
			var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
			ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
			var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
		})();
	</script>

 -->


</body>
</html>